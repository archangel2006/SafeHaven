<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support Disaster Relief - SafeHaven</title>
    <link rel="stylesheet" href="../assets/css/9.GetInvolved/Forms.css">
</head>
<body>
    <div class="top-header" id="pageTitle">
        Disaster in India
    </div>

    <div class="main-container">
        <div class="form-header">
            <div class="form-header-top">
                <div class="form-header-text">
                    <h1><span class="heart">‚ù§</span> Support Disaster Relief</h1>
                    <p class="selected-text">
                        (Selected: <span id="disasterName">Loading...</span>)
                    </p>
                </div>
                <button class="close-btn" type="button" onclick="window.history.back()">‚úï</button>
            </div>
        </div>

        <form id="donationForm" novalidate>
            <!-- 1. Enter Amount -->
            <div class="section">
                <div class="section-title"><span>1.</span>Enter Amount</div>
                <p class="section-subtitle">Choose a suggested amount or enter a custom donation.</p>

                <div class="amount-row">
                    <div class="amount-option">
                        <input type="radio" name="amount" id="amount500" value="500">
                        <label for="amount500">‚Çπ 500</label>
                    </div>
                    <div class="amount-option">
                        <input type="radio" name="amount" id="amount1000" value="1000">
                        <label for="amount1000">‚Çπ 1,000</label>
                    </div>
                    <div class="amount-option">
                        <input type="radio" name="amount" id="amount2500" value="2500">
                        <label for="amount2500">‚Çπ 2,500</label>
                    </div>
                </div>

                <div class="custom-amount-row">
                    <div class="custom-input-wrapper">
                        <input type="number" id="customAmount" placeholder="Custom amount" min="1">
                    </div>
                    <div class="currency-toggle">USD in INR ‚ñæ</div>
                </div>
            </div>

            <!-- 2. Your Information -->
            <div class="section">
                <div class="section-title"><span>2.</span>Your Information</div>
                <p class="section-subtitle">Share basic details so we can send your receipt and updates.</p>

                <div class="checkbox-row">
                    <input type="checkbox" id="anonymous">
                    <label for="anonymous">Donate anonymously</label>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="email">Email<span class="required">*</span></label>
                        <input type="email" id="email" class="form-control" required>
                        <span id="emailError" class="error-message">Enter a valid email.</span>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone<span class="required">*</span></label>
                        <input type="tel" id="phone" class="form-control" required pattern="[0-9]{10}" placeholder="10-digit number">
                        <span id="phoneError" class="error-message">Enter a 10-digit phone number.</span>
                    </div>
                    <div class="form-group">
                        <label for="name">Full Name<span class="required">*</span></label>
                        <input type="text" id="name" class="form-control" required>
                        <span id="nameError" class="error-message">Name is required.</span>
                    </div>
                    <div class="form-group">
                        <label for="age">Age<span class="required">*</span></label>
                        <input type="number" id="age" class="form-control" required min="18" max="120">
                        <span id="ageError" class="error-message">Age 18‚Äì120 only.</span>
                    </div>
                    <div class="form-group">
                        <label for="job">Job<span class="required">*</span></label>
                        <input type="text" id="job" class="form-control" required>
                        <span id="jobError" class="error-message">Job is required.</span>
                    </div>
                </div>
            </div>

            <!-- 3. Fund Allocation -->
            <div class="section">
                <div class="section-title"><span>3.</span>Fund Allocation</div>
                <p class="section-subtitle">Choose how you‚Äôd like your donation to be used.</p>

                <div class="allocation-grid">
                    <label class="allocation-pill active">
                        <input type="radio" name="allocation" value="relief" checked>
                        <span>Disaster Relief Fund</span>
                    </label>
                    <label class="allocation-pill">
                        <input type="radio" name="allocation" value="medical">
                        <span>Medical Aid</span>
                    </label>
                    <label class="allocation-pill">
                        <input type="radio" name="allocation" value="food">
                        <span>Food & Shelter</span>
                    </label>
                    <label class="allocation-pill">
                        <input type="radio" name="allocation" value="org">
                        <span>Let Organization Decide</span>
                    </label>
                </div>
            </div>

            <!-- Donate button -->
            <div class="submit-section">
                <button id="proceedBtn" type="button" disabled>Donate Securely</button>
            </div>

            <!-- Trust & Payment Footer -->
            <div class="trust-footer">
                <div class="trust-row">
                    <span class="lock-icon">üîí</span>
                    <span class="trust-text">
                        <strong>100% safe &amp; secure.</strong>
                        Trusted partners: <span class="partners">IFRC</span>
                    </span>
                </div>
                <div class="payment-icons">
                    <div class="payment-icon upi-icon">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/UPI-Logo-vector.svg/200px-UPI-Logo-vector.svg.png"
                             alt="UPI">
                    </div>
                    <div class="payment-icon card-icon">
                        <svg width="32" height="20" viewBox="0 0 32 20" fill="none">
                            <rect width="32" height="20" rx="3" fill="#0066CC" />
                            <rect x="2" y="2" width="28" height="16" rx="2" fill="#fff" />
                            <rect x="2" y="6" width="28" height="4" fill="#0066CC" />
                        </svg>
                    </div>
                    <div class="payment-icon card-icon">
                        <svg width="32" height="20" viewBox="0 0 32 20" fill="none">
                            <rect width="32" height="20" rx="3" fill="#FF5F00" />
                            <circle cx="12" cy="10" r="6" fill="#EB001B" />
                            <circle cx="20" cy="10" r="6" fill="#F79E1B" />
                        </svg>
                    </div>
                    <div class="payment-icon paypal-icon">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/PayPal.svg/200px-PayPal.svg.png"
                             alt="PayPal">
                    </div>
                </div>
            </div>

            <!-- QR + confirm -->
            <div id="qrSection" class="qr-section">
                <div class="qr-card">
                    <div class="qr-header">
                        <div class="qr-title">Scan &amp; Pay</div>
                        <div class="qr-subtitle">Use any UPI or banking app</div>
                    </div>
                    <div class="qr-body">
                        <div class="qr-image-wrapper">
                            <img src="https://api.qrserver.com/v1/create-qr-code/?size=190x190&data=upi://pay?pa=safehaven@upi"
                                 alt="QR Code">
                        </div>
                        <div class="qr-text">
                            <p>Open your payment app, scan this QR, and complete the transfer.</p>
                            <p class="qr-note">You‚Äôll see ‚ÄúSafeHaven Relief Fund‚Äù as the recipient.</p>
                            <button id="submitBtn" type="button" class="qr-confirm-btn">I have completed the payment</button>
                            <div id="thankToast" class="toast">
                                Thank you for your generous donation! Your support means a lot.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <script>
        // set disaster from URL
        const params = new URLSearchParams(window.location.search);
        const disaster = decodeURIComponent(params.get("disaster") || "Severe Floods in India");
        document.getElementById("disasterName").textContent = disaster;
        document.getElementById("pageTitle").textContent = disaster;

        const amountRadios = document.querySelectorAll('input[name="amount"]');
        const customAmount = document.getElementById("customAmount");
        const proceedBtn = document.getElementById("proceedBtn");
        const qrSection = document.getElementById("qrSection");
        const submitBtn = document.getElementById("submitBtn");
        const thankToast = document.getElementById("thankToast");

        const requiredFields = ["email", "phone", "name", "age", "job"];

        // allocation pills active style
        document.querySelectorAll(".allocation-pill").forEach(pill => {
            pill.addEventListener("click", () => {
                document.querySelectorAll(".allocation-pill").forEach(p => p.classList.remove("active"));
                pill.classList.add("active");
            });
        });

        // preset amounts
        amountRadios.forEach(radio => {
            radio.addEventListener("change", () => {
                if (radio.checked) customAmount.value = "";
                checkReady();
            });
        });

        // custom amount
        if (customAmount) {
            customAmount.addEventListener("input", () => {
                if (customAmount.value) {
                    amountRadios.forEach(r => r.checked = false);
                }
                checkReady();
            });
        }

        // field listeners
        requiredFields.forEach(id => {
            const input = document.getElementById(id);
            const err = document.getElementById(id + "Error");
            if (!input) return;

            input.addEventListener("input", () => {
                if (input.classList.contains("error")) validateField(input, err);
                checkReady();
            });
            input.addEventListener("blur", () => validateField(input, err));
        });

        function validateField(input, errSpan) {
            if (!input) return true;
            if (!input.checkValidity()) {
                input.classList.add("error");
                if (errSpan) errSpan.style.display = "block";
                return false;
            } else {
                input.classList.remove("error");
                if (errSpan) errSpan.style.display = "none";
                return true;
            }
        }

    </script>
    <script src="../8.AIAssistant/chatbot.js"></script>


        function hasAmount() {
            const selected = document.querySelector('input[name="amount"]:checked');
            const customVal = customAmount ? customAmount.value.trim() : "";
            return !!selected || !!customVal;
        }

        function allFieldsFilled() {
            return requiredFields.every(id => {
                const el = document.getElementById(id);
                return el && el.value.trim() !== "" && el.checkValidity();
            });
        }

        function checkReady() {
            const ready = hasAmount() && allFieldsFilled();
            proceedBtn.disabled = !ready;
        }

        // show QR section
        proceedBtn.addEventListener("click", () => {
            let ok = true;
            requiredFields.forEach(id => {
                const input = document.getElementById(id);
                const err = document.getElementById(id + "Error");
                if (input && !validateField(input, err)) ok = false;
            });
            if (!hasAmount()) ok = false;
            if (!ok) return;

            qrSection.style.display = "block";
            qrSection.scrollIntoView({ behavior: "smooth", block: "center" });
        });

        // final confirmation
        submitBtn.addEventListener("click", () => {
            thankToast.style.display = "block";
            setTimeout(() => { thankToast.style.display = "none"; }, 4000);
        });
    </script>
</body>
</html>
